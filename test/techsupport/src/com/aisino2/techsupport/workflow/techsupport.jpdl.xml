<?xml version="1.0" encoding="UTF-8"?>

<process key="techsupport2" name="techsupport" version="1" xmlns="http://jbpm.org/4.4/jpdl">
   <start g="34,16,48,48" name="start1">
      <transition to="ce_appr"/>
   </start>
   <task candidate-users="#{trackingUsers}" form="/business/techSupport/tracking/tracking.jsp" g="361,124,144,52" name="tracking_appr">
      <description>追踪批复</description>
      <transition to="terminate_exception_proc"/>
   </task>
   <end g="566,416,48,48" name="end"/>
   <task candidate-users="#{feedbackUsers}" form="/business/techSupport/feedback/feedback.jsp" g="565,123,92,52" name="feedback">
   	  <description>反馈确认</description>
      <transition to="archive"/>
      <transition g="526,38:-85,-25" name="no_feedback" to="tracking_appr"/>
   </task>
   <task candidate-users="#{archiveUsers}" form="/business/techSupport/archive/archive.jsp" g="719,103,92,52" name="archive">
   	  <description>归档</description>
      <transition to="end"/>
   </task>
   <task candidate-users="#{ceApprovalUsers}" form="/business/techSupport/ceApproval/ceApproval.jsp" g="12,99,112,51" name="ce_appr">
   	  <description>公司审批/总工审批</description>
      <transition to="ce_appr_condition"/>
   </task>
   <task candidate-users="#{deptApprovalUsers}" form="/business/techSupport/deptApproval/deptApproval.jsp" g="76,187,157,52" name="department_appr">
      <description>部门审批</description>
      <transition to="department_appr_condition"/>
   </task>
   <decision expr="#{ceApprovalCode == approvalCodePassed ? 'department_appr':'end'}" g="49,300,48,48" name="ce_appr_condition">
      <description>公司审批条件/总工审批条件</description>
      <transition g="-85,-25" name="department_appr" to="department_appr"/>
      <transition g="-62,-25" name="end" to="end"/>
   </decision>
   <decision expr="#{ deptApprovalCode == approvalCodePassed  ? 'tracking_appr' : 'ce_appr' }" g="179,62,48,48" name="department_appr_condition">
   	  <description>部门审批条件</description>
      <transition g="-53,-15" name="ce_appr" to="ce_appr"/>
      <transition g="-65,-69" name="tracking_appr" to="exception_tracking_fork"/>
   </decision>
   
   <fork g="248,86,100,60" name="exception_tracking_fork">
   	<description>例外追踪处理分支</description>
   	<transition to="tracking_appr"/>
   	<transition to="exception_process"/>
   </fork>
   <task candidate-users="#{exception_handling_users}" form="/business/techSupport/exception/exception.jsp" g="250,204,171,46" name="exception_process">
   	<description>例外处理</description>
   	<transition to="end"/>
   </task>
   <join g="483,204,48,48" multiplicity="1" name="terminate_exception_proc">
      <description>结束例外处理分支</description>
      <transition to="feedback"/>
   </join>
</process>