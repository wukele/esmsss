<?xml version="1.0" encoding="UTF-8"?>

<process key="techsupport1" name="技术支持单" version="5" xmlns="http://jbpm.org/4.4/jpdl">
   <start g="34,16,48,48" name="start1">
      <transition to="总工审批"/>
   </start>
   <task candidate-users="#{trackingUsers}" form="/business/techSupport/tracking/tracking.jsp" g="361,124,92,52" name="追踪批复">
      <transition to="结束例外处理分支"/>
   </task>
   <end g="566,416,48,48" name="结束"/>
   <task candidate-users="#{feedbackUsers}" form="/business/techSupport/feedback/feedback.jsp" g="565,123,92,52" name="反馈确认">
      <transition to="归档"/>
      <transition g="526,38:-85,-25" name="不与反馈" to="追踪批复"/>
   </task>
   <task candidate-users="#{archiveUsers}" form="/business/techSupport/archive/archive.jsp" g="719,103,92,52" name="归档">
      <transition to="结束"/>
   </task>
   <task candidate-users="#{ceApprovalUsers}" form="/business/techSupport/ceApproval/ceApproval.jsp" g="12,99,92,52" name="总工审批">
      <transition to="是否总工审批通过"/>
   </task>
   <task candidate-users="#{deptApprovalUsers}" form="/business/techSupport/deptApproval/deptApproval.jsp" g="108,187,92,52" name="部门审批">
      <transition to="部门审批条件"/>
   </task>
   <decision expr="#{ceApprovalCode == approvalCodePassed ? '部门审批':'结束'}" g="49,300,48,48" name="是否总工审批通过">
      <transition g="-85,-25" name="部门审批" to="部门审批"/>
      <transition g="-62,-25" name="结束" to="结束"/>
   </decision>
   <decision expr="#{ deptApprovalCode == approvalCodePassed  ? '追踪批复' : '总工审批' }" g="168,69,48,48" name="部门审批条件">
      <transition g="-53,-15" name="总工审批" to="总工审批"/>
      <transition g="-65,-69" name="追踪批复" to="例外追踪分支"/>
   </decision>
   
   <fork g="248,86,100,60" name="例外追踪分支">
   	<transition to="追踪批复"/>
   	<transition to="例外处理"/>
   </fork>
   <task candidate-users="#{exceptionHandlingUsers}" form="/business/techSupport/exception/exception.jsp" g="234,180,80,40" name="例外处理">
   	<transition to="结束"/>
   </task>
   <join name="结束例外处理分支" g="483,204,48,48" multiplicity="1">
      <transition to="反馈确认"/>
   </join>
</process>